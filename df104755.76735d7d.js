(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{133:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return o})),a.d(t,"rightToc",(function(){return p})),a.d(t,"default",(function(){return c}));var n=a(2),r=a(6),l=(a(0),a(155)),i={id:"use-odata-v4-type-safe-client-for-javascript-typescript",title:"Use the OData v4 client for JavaScript / TypeScript",sidebar_label:"OData v4 client API",description:"Use the SAP Cloud SDK for JavaScript to build and run OData v4 requests in a type-safe way.",keywords:["sap","cloud","sdk","odata","JavaScript","TypeScript","consume"]},o={unversionedId:"js/features/odata/use-odata-v4-type-safe-client-for-javascript-typescript",id:"js/features/odata/use-odata-v4-type-safe-client-for-javascript-typescript",isDocsHomePage:!1,title:"Use the OData v4 client for JavaScript / TypeScript",description:"Use the SAP Cloud SDK for JavaScript to build and run OData v4 requests in a type-safe way.",source:"@site/docs/js/features/odata/odata-v4-client.mdx",slug:"/js/features/odata/use-odata-v4-type-safe-client-for-javascript-typescript",permalink:"/cloud-sdk/docs/js/features/odata/use-odata-v4-type-safe-client-for-javascript-typescript",editUrl:"https://github.com/SAP/cloud-sdk/edit/documentation/docs/js/features/odata/odata-v4-client.mdx",version:"current",lastUpdatedBy:"Frank Essenberger",lastUpdatedAt:1600841567,sidebar_label:"OData v4 client API",sidebar:"someSidebar",previous:{title:"Use the OData v2 client for JavaScript / TypeScript",permalink:"/cloud-sdk/docs/js/features/odata/use-odata-v2-type-safe-client-for-javascript-typescript"},next:{title:"Destinations in the SAP Cloud SDK for JavaScript / TypeScript",permalink:"/cloud-sdk/docs/js/features/connectivity/destination-js-sdk"}},p=[{value:"Making a request using a generated OData v4 client",id:"making-a-request-using-a-generated-odata-v4-client",children:[{value:"Filter",id:"filter",children:[]},{value:"Expand",id:"expand",children:[]}]}],s={rightToc:p};function c(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(l.b)("wrapper",Object(n.a)({},s,a,{components:t,mdxType:"MDXLayout"}),Object(l.b)("p",null,"For more details on ",Object(l.b)("strong",{parentName:"p"},"how to execute requests")," using a (pre-)generated OData client refer to ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"./executing-a-request-using-a-generated-odata-v2-v4-client-with-sap-cloud-sdk-for-javascript"}),"this documentation"),"."),Object(l.b)("h2",{id:"making-a-request-using-a-generated-odata-v4-client"},"Making a request using a generated OData v4 client"),Object(l.b)("h3",{id:"filter"},"Filter"),Object(l.b)("h4",{id:"filter-on-one-to-many-navigation-properties"},"Filter on One-To-Many Navigation Properties"),Object(l.b)("p",null,"OData V4 introduces ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"http://docs.oasis-open.org/odata/odata/v4.01/odata-v4.01-part2-url-conventions.html#sec_LambdaOperators"}),"lambda operators")," e.g., ",Object(l.b)("inlineCode",{parentName:"p"},"any"),"/",Object(l.b)("inlineCode",{parentName:"p"},"all"),", so that the root property of the one-to-many navigation properties can be filtered.\nBelow is an example that demonstrates how to use the lambda operator ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"pathname:///api/1.28.1/modules/sap_cloud_sdk_core#any"}),"any"),"."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"/*\n  Get all people that have at least one friend that matches all the following conditions:\n    - Has first name 'firstName'\n    - Has last name 'lastName'\n*/\n.filter(\n  any(\n    People.FRIENDS.filter(\n      People.FIRST_NAME.equals('firstName'),\n      People.LAST_NAME.equals('lastName')\n    )\n  )\n)\n")),Object(l.b)("p",null,"The generated ",Object(l.b)("inlineCode",{parentName:"p"},"$filter")," parameter of the URL will be:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sql"}),"$filter=(/any(a0:((a0/Friends/FirstName eq 'firstName' and a0/Friends/LastName eq 'lastName'))))\n")),Object(l.b)("h3",{id:"expand"},"Expand"),Object(l.b)("h4",{id:"expand-and-select"},"Expand and Select"),Object(l.b)("p",null,"In contrast to the OData v2 implementation, you have ",Object(l.b)("inlineCode",{parentName:"p"},"select")," and ",Object(l.b)("inlineCode",{parentName:"p"},"expand")," separately.\nIn other words selected properties are not expanded automatically as in v2."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"People.requestBuilder().getAll()\n    .select(People.LAST_NAME)\n    .expand(People.FRIENDS.select(People.FIRST_NAME,People.ADDRESS_INFO))\n")),Object(l.b)("p",null,"In the example above you select the ",Object(l.b)("inlineCode",{parentName:"p"},"LAST_NAME")," of the root entity and expand the navigation property ",Object(l.b)("inlineCode",{parentName:"p"},"FRIENDS"),".\nIn the expanded entity the selected fields are ",Object(l.b)("inlineCode",{parentName:"p"},"FIRST_NAME")," and ",Object(l.b)("inlineCode",{parentName:"p"},"ADDRESS_INFO"),"."),Object(l.b)("p",null,"The generated URL for this request will be:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sql"}),"/People?$select=LastName&$expand=Friends($select=FirstName,AddressInfo)\n")),Object(l.b)("p",null,"If no select is given, all non-navigational properties are included in the response."),Object(l.b)("h4",{id:"sub-queries-in-expand"},"Sub-queries in Expand"),Object(l.b)("p",null,"Note that you can create very complex queries within the expand scope:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),'People.requestBuilder().getAll()\n    .expand(People.FRIENDS\n      .select(People.FIRST_NAME,People.ADDRESS_INFO)\n      .filter(People.LAST_NAME.equals("Miller"))\n      .orderBy(asc(People.GENDER))\n      .top(1)\n      .skip(1)\n    )\n')),Object(l.b)("p",null,"In this example the filter will reduce the friends to be shown.\nThe effect of a filter depends whether it is used in or outside of an expand.\nThe different cases are explained in ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"#filterParentChildren"}),"Filters in Expand.")),Object(l.b)("p",null,"The URL for the query will be:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sql"}),"/People?$expand=Friends($select=FirstName,AddressInfo;$filter=(LastName eq 'Miller');$skip=1;$top=1;$orderby=Gender asc)\n")),Object(l.b)("h4",{id:"filter-parent-vs-filter-children"},"Filter parent vs. Filter children ",Object(l.b)("a",{name:"filterParentChildren"})),Object(l.b)("p",null,"Depending on the context of the filter it will either filter the parent or the children.\nIn our example we have a ",Object(l.b)("inlineCode",{parentName:"p"},"PERSON")," related to 0..N ",Object(l.b)("inlineCode",{parentName:"p"},"FRIENDS")," which are both of type people."),Object(l.b)("p",null,"If you want to get all people with first name ",Object(l.b)("inlineCode",{parentName:"p"},"John")," the query is:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"People.requestBuilder().getAll()\n    .filter(People.FIRST_NAME.equals('John'))\n")),Object(l.b)("p",null,"If you want to get all people who have at least one friend with first name ",Object(l.b)("inlineCode",{parentName:"p"},"John")," the query is:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"People.requestBuilder().getAll().filter(People.FRIENDS\n    .filter(\n        any(People.FIRST_NAME.equals('John'))\n    )\n)\n")),Object(l.b)("p",null,"The lambda ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"pathname:///api/1.28.1/modules/sap_cloud_sdk_core#all"}),"all")," would enforce that all friends must have first name ",Object(l.b)("inlineCode",{parentName:"p"},"John"),".\nThe two queries above filter the parent entity person."),Object(l.b)("p",null,"In case you want to get all people but reduce the friends in the response, the filter has to be inside the expand:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"People.requestBuilder().getAll()\n    .expand(People.FRIENDS\n        .filter(People.FIRST_NAME.equals('John'))\n    )\n")),Object(l.b)("p",null,"This will return all people but only the friends with first name ",Object(l.b)("inlineCode",{parentName:"p"},"John")," will be included in the response."))}c.isMDXComponent=!0},155:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return f}));var n=a(0),r=a.n(n);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createContext({}),c=function(e){var t=r.a.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=c(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,i=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),d=c(a),b=n,f=d["".concat(i,".").concat(b)]||d[b]||u[b]||l;return a?r.a.createElement(f,o(o({ref:t},s),{},{components:a})):r.a.createElement(f,o({ref:t},s))}));function f(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,i=new Array(l);i[0]=b;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:n,i[1]=o;for(var s=2;s<l;s++)i[s]=a[s];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,a)}b.displayName="MDXCreateElement"}}]);