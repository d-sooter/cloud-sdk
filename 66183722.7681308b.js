(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{157:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return b}));var r=n(0),i=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=i.a.createContext({}),u=function(e){var t=i.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},p=function(e){var t=u(e.components);return i.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},h=i.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,a=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),p=u(n),h=r,b=p["".concat(a,".").concat(h)]||p[h]||d[h]||o;return n?i.a.createElement(b,c(c({ref:t},l),{},{components:n})):i.a.createElement(b,c({ref:t},l))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,a=new Array(o);a[0]=h;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,a[1]=c;for(var l=2;l<o;l++)a[l]=n[l];return i.a.createElement.apply(null,a)}return i.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},159:function(e,t,n){"use strict";var r=n(0),i=n(19);t.a=function(){var e=Object(r.useContext)(i.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},160:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(159),i=n(161);function o(){var e=Object(r.a)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,o=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,r){var o=void 0===r?{}:r,a=o.forcePrependBaseUrl,c=void 0!==a&&a,s=o.absolute,l=void 0!==s&&s;if(!n)return n;if(n.startsWith("#"))return n;if(Object(i.b)(n))return n;if(c)return t+n;var u=!n.startsWith(t)?t+n.replace(/^\//,""):n;return l?e+u:u}(o,n,e,t)}}}function a(e,t){return void 0===t&&(t={}),(0,o().withBaseUrl)(e,t)}},161:function(e,t,n){"use strict";function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function i(e){return void 0!==e&&!r(e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},92:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return p}));var r=n(2),i=n(6),o=(n(0),n(157)),a=n(160),c={title:"On-Premise Connectivity in the SAP Cloud SDK for JavaScript",sidebar_label:"On-Premise Systems",description:"How to connect to SAP S/4 HANA On-Premise systems using the SAP Cloud SDK",keywords:["sap","cloud","sdk","On-Premise","connectivity","JavaScript","TypeScript"]},s={unversionedId:"js/features/connectivity/on-premise",id:"js/features/connectivity/on-premise",isDocsHomePage:!1,title:"On-Premise Connectivity in the SAP Cloud SDK for JavaScript",description:"How to connect to SAP S/4 HANA On-Premise systems using the SAP Cloud SDK",source:"@site/docs/js/features/connectivity/on-premise.mdx",slug:"/js/features/connectivity/on-premise",permalink:"/cloud-sdk/docs/js/features/connectivity/on-premise",editUrl:"https://github.com/SAP/cloud-sdk/edit/documentation/docs/js/features/connectivity/on-premise.mdx",version:"current",lastUpdatedBy:"Frank Essenberger",lastUpdatedAt:1600081239,sidebar_label:"On-Premise Systems",sidebar:"someSidebar",previous:{title:"Proxies in the SAP Cloud SDK for JavaScript / TypeScript",permalink:"/cloud-sdk/docs/js/features/connectivity/proxy-js-sdk"},next:{title:"Migrate to Open Source version of SDK for JS/TS",permalink:"/cloud-sdk/docs/js/guides/migrate-to-open-source-version-of-cloud-sdk-for-javascript-typescript"}},l=[{value:"Why On-Premise Systems are Different",id:"why-on-premise-systems-are-different",children:[]},{value:"Implementation Details",id:"implementation-details",children:[{value:"Connectivity Service",id:"connectivity-service",children:[]},{value:"Principal Propagation",id:"principal-propagation",children:[]},{value:"Multiple Cloud Connectors",id:"multiple-cloud-connectors",children:[]}]}],u={rightToc:l};function p(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"why-on-premise-systems-are-different"},"Why On-Premise Systems are Different"),Object(o.b)("p",null,"The crucial problem with SAP S/4HANA On-Premise systems is, that they are not exposed to the internet.\nTypically, they are located within a company's internal network.\nThe SAP CLoud SDK has some useful features that allow you to connect to On-Premise systems."),Object(o.b)("p",null,"Since this isolation contradicts to modern requirements of data availability, SAP has introduced the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/e6c7616abb5710148cfcf3e75d96d596.html?q=cloud%20connector"}),"Cloud Connector"),".\nThe Cloud Connector works like a reverse proxy opening a connection between some white-listed service endpoints of the On-Premise system, and the connected Cloud Foundry account.\nOnly applications running in the connected Cloud Foundry account can access the services.\nApplications which are supposed to access On-Premise systems need a binding to the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.cloudfoundry.org/the-foundry/sap-cloud-platform-service-connectivity/"}),"connectivity service"),"."),Object(o.b)("img",{alt:"Destination in CF",src:Object(a.a)("img/on-premise-connectivity.png"),class:"center",width:"100%"}),Object(o.b)("h2",{id:"implementation-details"},"Implementation Details"),Object(o.b)("h3",{id:"connectivity-service"},"Connectivity Service"),Object(o.b)("p",null,"As a first step, the SDK ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/cloud-sdk/docs/js/features/connectivity/destination-js-sdk"}),"looks up the destination"),".\nIf the ",Object(o.b)("inlineCode",{parentName:"p"},"Proxy Type")," of the destination is ",Object(o.b)("inlineCode",{parentName:"p"},"OnPremise")," the SDK will try to establish a connection via the Cloud Connector."),Object(o.b)("p",null,"As mentioned above, the application needs a service binding to the connectivity service.\nA service binding leads to client credentials in the  ",Object(o.b)("inlineCode",{parentName:"p"},"VCAP")," environment variable.\nThe environment variables are accessible for the application at runtime.",Object(o.b)("br",{parentName:"p"}),"\n","The SDK uses the client credentials and if given the tenant id of the JWT to obtain a ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://help.sap.com/viewer/8d8be6a74e4e49589a546c02ee193741/latest/en-US/f1eff1dd7907469491989b3a36e6a7c6.html"}),"client credentials grant."),"\nIf multiple connectivity services binding exist, the SDK uses the first entry per default."),Object(o.b)("p",null,"The SDK takes the client grant to call the connectivity service and receives the host, password and authorization of the connectivity proxy.\nThen the SDK creates an HTTP agent considering this proxy and the necessary ",Object(o.b)("inlineCode",{parentName:"p"},"Proxy-Authorization")," headers.\nThe proxy is the entry point to the Cloud Connector instance connected the account.\nThe proxy is only reachable from the Cloud Foundry space, so you cannot use that flow for applications running outside of Cloud Foundry.\nThe final destination containing the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/cloud-sdk/docs/js/features/connectivity/proxy-js-sdk"}),"proxy information")," will look like:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-JSON"}),'{\nurl: "https://my.onPremise.System.url.com",\nheaders: {...},    //contains authorization headers for the SAP S/4HANA system \nproxyConfiguration?: {\n  host: "connectivity.service.proxy.host"\n  port: 1234\n  protocol: "http"\n  headers?: {\n      Proxy-Authorization: "AuthHeaderForTheProxy" \n    };,\n  }\n}\n')),Object(o.b)("p",null,"and will be used by the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/cloud-sdk/docs/js/features/odata/generic-http-client"}),"HTTP client")," of the SDK to execute the request.\nWe would like to mention two minor aspects of the SDK."),Object(o.b)("h3",{id:"principal-propagation"},"Principal Propagation"),Object(o.b)("p",null,"In case the ",Object(o.b)("inlineCode",{parentName:"p"},"Authentication")," property on the destination is ",Object(o.b)("inlineCode",{parentName:"p"},"PrincipalPropagation")," the SDK adds the ",Object(o.b)("inlineCode",{parentName:"p"},"SAP-Connectivity-Authentication")," header to the request.\nThe header contains user information included in the ",Object(o.b)("inlineCode",{parentName:"p"},"JWT")," and enables user propagation from the cloud application to the SAP S/4 HANA system."),Object(o.b)("h3",{id:"multiple-cloud-connectors"},"Multiple Cloud Connectors"),Object(o.b)("p",null,"If you have multiple Cloud Connectors connected to your account, the ",Object(o.b)("inlineCode",{parentName:"p"},"LocationId")," defines which one of these to use for the request.\nIn case the destination contains a  ",Object(o.b)("inlineCode",{parentName:"p"},"LocationId")," property, the SDK adds the ",Object(o.b)("inlineCode",{parentName:"p"},"SAP-Connectivity-SCC-Location_ID")," header to the request."))}p.isMDXComponent=!0}}]);